<!doctype html>
<html>
  <head>
     <title></title>
     <script src='https://unpkg.com/requirejs/require.js'></script>
     <section data-id='import'></section>
  </head>
  <body>
    <style>
      #app{
        width: 100%;
        height: 100%;
      }
      body, html{
        margin: 0;
        padding: 0;
        clear: both;
      }
    </style>
    <div id='app'></div>
     <script>
       requirejs.config({
          paths: {
             "unpkg": "https://unpkg.com" 
          }
       });

       var Importer = (function(){
        function req(str){
           return new Promise((ac, re) => require([str], ac));
        }

        function reqall(...args){
           return Promise.all(args.map(req));
      }

        function linkCss(src){
          return function(f, g){
            var a = document.createElement("link");
            a.rel = "stylesheet";
            a.href = src;
            a.type = 'text/css';
            a.onload = f;
            a.onerror = g;
            document.body.querySelector("[data-id='import']").appendChild(a)
          }
        }

        function resolve(name){
          switch(true){
            case /^:/.test(name):{
              return new Promise((ac, re) => {
                ac(eval(name.slice(1)));
              });
            }
            case /\.css$/.test(name): {
              return new Promise(linkCss(name.replace(/^&/, "https://unpkg.com/")));
            }
            case /^&/.test(name): {
              var src = name.replace(/^&/, "unpkg/");
              return req(src);
            }
          }
        }
         
        return {
          req, reqall, linkCss, resolve
        }
       })();

       var a = window.location.search.slice(1);
       Promise.all(a.split(";").map(Importer.resolve)).then(_ => console.log("Hello world"));
     </script>
  </body>
</html>

